# Alerting Rules ESSENCIAIS para Demonstra칞칚o de Toler칙ncia a Falhas
# APENAS os alertas necess치rios para a demo
groups:
  - name: patocash_demo_alerts
    interval: 15s
    rules:
      # Para demonstrar HPA - CPU alta acionando escalonamento
      - alert: PatoCashHPATriggered
        expr: patocash:backend_total_cpu_percent > 50
        for: 30s
        labels:
          severity: info
          demo: hpa-scaling
        annotations:
          summary: "游 HPA acionado - CPU alta detectada"
          description: "CPU total do backend est치 em {{ $value }}%. HPA deve escalonar pods automaticamente."

      # Para demonstrar HPA - Escalonamento ativo
      - alert: PatoCashHPAScaling
        expr: patocash:hpa_current_replicas > 2
        for: 15s
        labels:
          severity: info
          demo: hpa-scaling
        annotations:
          summary: "游늳 HPA escalonando - {{ $value }} replicas ativas"
          description: "HPA aumentou o n칰mero de replicas para {{ $value }} devido ao aumento de CPU."

      # Para demonstrar Auto-healing - Pod sendo recriado
      - alert: PatoCashPodCountChanged
        expr: changes(patocash:backend_pod_count[2m]) != 0
        for: 10s
        labels:
          severity: info
          demo: auto-healing
        annotations:
          summary: "游댃 Auto-healing detectado - mudan칞a no n칰mero de pods"
          description: "N칰mero de pods backend mudou para {{ $value }}. Kubernetes est치 fazendo auto-healing."